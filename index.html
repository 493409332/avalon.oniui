
<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script src="avalon.js"></script>
        <!--不能直接用script引入mmRequest.js-->
        <script>

            var avalonAjax
            var model = avalon.define("test", function(vm) {
                vm.username = ""
                vm.password = ""
                vm.email = ""
                vm.ajax = function(e) {
                    if (avalonAjax) {
                        avalon.post("/post", avalon.serialize(this), function(a) {
                            avalon.log(a)
                        }, "text")
                    }
                    e.preventDefault()
                }
                vm.get = function() {
                    avalon.get("/get", function(a) {
                        avalon.log(a)
                    },"text")
                }
                vm.getJSON = function() {
                    avalon.getJSON("/getjson", function(a) {
                        avalon.log(a)
                    })
                }
            })


            require(["./mmRequest","ready!"], function(avalon) {
                avalonAjax = avalon.ajax
                var form = document.getElementById("ttt")
                console.log(avalon.serialize(form))
                // avalon.log(avalonAjax)
            })




        </script>
    </head>
    <body ms-controller="test">
        <h3>测试AJAX</h3>
        <ul>
            <li>avalon.ajax</li>
            <li>avalon.post</li>
            <li>avalon.get</li>
            <li>avalon.upload</li>
        </ul>
        <form ms-controller='article_form' ms-on-submit='articleAction' id="ttt">
  <input type="hidden" ms-duplex='id'>
  <label for="title">title</label>
  <input type="text" id='title' name='title' ms-duplex='title'>
  <br>
  <label for="content">content</label>
  <textarea id="content" name='content' cols="60" rows="10" ms-duplex='content'></textarea>
  <br>
  <button>submit</button>
</form>
        <form action="/post"   ms-on-submit="ajax" >
            <div>帐号:<input name="username" ms-duplex="username"></div>
            <div>密码:<input name="password" ms-duplex="password"></div>
            <div>邮箱:<input name="email" ms-duplex="email"></div>
            <button type="submit">avalon.post</button>
        </form>
        <button type="button" ms-click="get">avalon.get</button>
        <button type="button" ms-click="getJSON">getJSON</button>
    </body>
</html>
